"use strict";var StateMachine;!function(t){function e(t){return"undefined"==typeof t}var n=function(){function t(t,e){this._sm=t,this.name=e,this._events={},this._enter=[],this._exit=[]}return t.prototype._makeEventHandler=function(t){var e=this;if("function"==typeof t)return t;if("string"==typeof t)return function(){return e._sm.go(t)};if("undefined"==typeof t)return function(){return void 0};throw new Error("invalid event handler")},t.prototype.on=function(t,e){var n=this._events,r=(this._sm,this._makeEventHandler(e));switch(t){case"enter":this._enter.push(r);break;case"exit":this._exit.push(r);break;default:n.hasOwnProperty(t)||(n[t]=[]),n[t].push(r)}return this},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=this._sm,o=i.options.verbose,s=i.options.name,a=i.options.logExceptions,h=this;if(null===h)throw new Error("the state machine has not been initialized");if(r=h._events,!r.hasOwnProperty(t))throw new Error(t+" event not defined for "+h.name+" state");if(o&&console.log(s+": "+h.name+"."+t),a)try{r[t].forEach(function(t){return t.apply(i,e)})}catch(u){throw console.log(s+": "+h.name+" ! "+u.message),u}else r[t].forEach(function(t){return t.apply(i,e)})},t}();t.State=n;var r=function(){function t(t){this._states={},this.current=null,e(t)&&(t={}),e(t.verbose)&&(t.verbose=!1),e(t.name)&&(t.name="StateMachine"),e(t.logExceptions)&&(t.logExceptions=!1),this.options=t}return t.prototype.init=function(t){var n=this._states;if(e(n[t]))throw new Error(t+" state is not defined");this.current=n[t]},t.prototype.state=function(t){var e=this._states;return e.hasOwnProperty(t)||(e[t]=new n(this,t)),e[t]},t.prototype.emit=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var n=this.current;if(null===n)throw new Error("the state machine has not been initialized");n.emit.apply(n,arguments)},t.prototype.go=function(t){var n=this,r=this._states[t],i=this.current,o=function(t){return t.call(n)};if(e(r))throw new Error(t+" state does not exist");i.name!==t&&(this.options.verbose&&console.log(this.options.name+": "+i.name+" -> "+t),i._exit.forEach(o),this.current=r,r._enter.forEach(o))},t}();t.StateMachine=r}(StateMachine||(StateMachine={}));
//# sourceMappingURL=StateMachine.js.map